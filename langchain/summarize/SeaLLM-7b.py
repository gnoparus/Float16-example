from langchain.chat_models import ChatOpenAI
from langchain.prompts import ChatPromptTemplate
from langchain_core.output_parsers import StrOutputParser
import dotenv 
import os
dotenv.load_dotenv()

FLOAT16_BASE_URL = os.getenv("FLOAT16_BASE_URL")
FLOAT16_API_KEY = os.getenv("FLOAT16_API_KEY")
FLOAT16_CUSTOM_URL = os.getenv("FLOAT16_CUSTOM_URL")

model = ChatOpenAI(
    model="seallm-7b",
    api_key=FLOAT16_API_KEY,
    base_url=FLOAT16_BASE_URL,
    max_tokens=256,
    temperature=0.1,
    model_kwargs={
        'stop':["</s>"],
    }
)
prompt = ChatPromptTemplate.from_messages([
    ("system", """You are secretary expert. You will receive text in Thai language and output with summarization in Thai language. no explanation. no extra words. DO NOT try to asnwer the question."""), 
    ("human", "Content : {input}. Please summarize the conten and response less than 5 words in Thai language."),
])

output_parser = StrOutputParser()

chain = prompt | model | output_parser


# สรุปเนื้อหา recommend to use v1.1
# res = chain.invoke({'input' : """รอคอยมานานกว่า 10 ปี ในที่สุดก็ได้ฤกษ์ดีเข้าพิธีวิวาห์ เริ่มต้นชีวิตคู่ในฐานะสามีภรรยา อย่างเป็นทางการ สำหรับ โก๊ะตี๋ อารามบอย และ น้องกวาง สุภัค  โดยล่าสุด! พี่ชายคนสนิท จตุรงค์ โพธาราม หรือ จตุรงค์ มกจ๊ก ได้แชร์คลิปวิดีโอที่เผยให้เห็นภาพพิธีมงคลสมรสในช่วงเช้า พร้อมระบุแคปชั่น "แต่งจารโก๊ะ+กวาง @kootee" ผ่านอินสตาแกรม @jaturong_p ซึ่งเป็นโมเมนต์ขณะคู่บ่าวสาว ญาติผู้ใหญ่ รวมถึงแขกคนสนิท กำลังร่วมกันทำบุญเลี้ยงพระ ท่ามกลางบรรยากาศอันเรียบง่ายและเป็นส่วนตัว  นอกจากนั้นแล้ว ในช่วงเย็นวันนี้ (17 ธันวาคม) โก๊ะตี๋ และ น้องกวาง จะจัดแถลงข่าวเปิดใจถึงเส้นทางความหวาน และแพลนครอบครัวในอนาคตกับสื่อมวลชน ณ ห้อง Basilica โพธาลัย เลเซอร์ ปาร์ค  ซึ่งทีมข่าวบันเทิง Sanook.com ต้องขอแสดงความยินดีกับทั้งคู่ไว้ด้วยนะคะ"""})
# res = chain.invoke({'input' : """ผู้สูงอายุรับเงินพิเศษ 3,000 บาท ไม่ต้องลงทะเบียน ชาวเน็ตถกสนั่น จริงมั้ย ล่าสุด พม. แจง ไม่จริง  ตามที่มีข่าวสารปรากฏเรื่องผู้สูงอายุ 60 ปีขึ้นไป รับเงินอุดหนุนพิเศษ 3,000 บาท ไม่ต้องลงทะเบียน ทางศูนย์ต่อต้านข่าวปลอมได้ดำเนินการตรวจสอบข้อเท็จจริง โดยกรมกิจการผู้สูงอายุ กระทรวงการพัฒนาสังคมและความมั่นคงของมนุษย์ พบว่าข้อมูลดังกล่าว เป็นข้อมูลเท็จ  จากการแชร์ข้อมูลข่าวสารว่า ผู้สูงอายุ 60 ปีขึ้นไป รับเงินอุดหนุนพิเศษ 3,000 บาท ไม่ต้องลงทะเบียน ทางกรมกิจการผู้สูงอายุ กระทรวงการพัฒนาสังคมและความมั่นคงของมนุษย์ ได้ตรวจสอบข้อมูลและชี้แจงว่า ข้อมูลดังกล่าวไม่ถูกต้อง เนื่องจากปัจจุบันยังไม่มีการเพิ่มเบี้ยยังชีพผู้สูงอายุตามคลิปที่กล่าวอ้าง โดยยังคงใช้ระเบียบกระทรวงมหาดไทยว่าด้วยหลักเกณฑ์การจ่ายเงินเบี้ยยังชีพผู้สูงอายุขององค์กรปกครอง ส่วนท้องถิ่น พ.ศ. 2566  ทั้งนี้ ระเบียบใหม่ได้กำหนดบทเฉพาะกาล ข้อ 17 วรรค 1 บรรดาผู้สูงอายุที่ได้ขึ้นทะเบียนและรับเงินเบี้ยยังชีพผู้สูงอายุจากองค์กรปกครองส่วนท้องถิ่น อยู่ก่อนระเบียบนี้ใช้บังคับให้ยังมีสิทธิรับเงินเบี้ยยังชีพผู้สูงอายุจากองค์กรปกครองส่วนท้องถิ่นนั้นต่อไป และ ข้อ 18 ในระหว่างที่คณะกรรมการผู้สูงอายุแห่งชาติตามกฎหมายว่าด้วยผู้สูงอายุ ยังมิได้มีการกำหนดคุณสมบัติของผู้มีสิทธิ ตามข้อ 6(4) ให้องค์กรปกครองส่วนท้องถิ่นใช้คุณสมบัติผู้รับเบี้ยยังชีพผู้สูงอายุตามระเบียบกระทรวงมหาดไทยว่าด้วยหลักเกณฑ์การจ่ายเงินเบี้ยยังชีพผู้สูงอายุขององค์กรปกครองส่วนท้องถิ่น พ.ศ. 2552 และที่แก้ไขเพิ่มเติมไปพลางก่อน  โดยมีปัจจุบันมีการจ่ายเบี้ยยังชีพให้แก่ผู้สูงอายุเป็นรายเดือนตามช่วงอายุ โอนให้ทุกวันที่ 10 ของเดือน ดังนี้  อายุ 60 – 69 ปี จะได้รับเบี้ยยังชีพ อัตรา 600 บาทต่อคนต่อเดือน อายุ 70 – 79 ปี จะได้รับเบี้ยยังชีพ อัตรา 700 บาทต่อคนต่อเดือน อายุ 80 – 89 ปี จะได้รับเบี้ยยังชีพ อัตรา 800 บาทต่อคนต่อเดือน อายุ 90 ปี ขึ้นไป จะได้รับเบี้ยยังชีพ อัตรา 1,000 บาทต่อคนต่อเดือน"""})
# res = chain.invoke({'input' : """ส่งคัมแบ็กด้วยมินิอัลบั้มใหม่ในรอบกว่า 1 ปี 9 เดือนกับ แทยอน ศิลปินสาวเสียงทรงพลัง เมนโวคอลจากเกิร์ลกรุ๊ปแห่งชาติ Girls’ Generation ด้วยซิงเกิลไตเติลในชื่อ To. X พร้อมปล่อยมิวสิกวิดีโอออกมาให้รับชมพร้อมกันในวันที่ 27 พฤศจิกายนที่ผ่านมา      To. X เป็นเพลงแนว R&B ผสมผสานการริฟฟ์กีตาร์และทำนองที่เป็นจังหวะ ร่วมด้วยเสียงร้องอันเป็นเอกลักษณ์ของแทยอน ที่ทำให้ผู้ฟังสามารถเข้าถึงห้วงอารมณ์และความหมายของบทเพลงผ่านน้ำเสียงของเธอได้เป็นอย่างดี ซึ่งเพลงนี้เป็นการเล่าเรื่องราวของความรักที่กำลังถูกอีกฝ่ายควบคุมจนเสียความเป็นตัวเองไป นำมาสู่จุดสิ้นสุดของความสัมพันธ์     ด้านมิวสิกวิดีโอของเพลงนี้ นำเสนอการเปลี่ยนแปลงทางอารมณ์ในความรักที่ไร้เหตุผลของคนรักที่พยายามตัดขาดจากตัวเองและโลก โดยแทยอนยังรับบทบาทแสดงนำในมิวสิกวิดีโอนี้ด้วยตัวเอง"""})
# res = chain.invoke({'input' : """อีลอน มัสก์ มหาเศรษฐีเจ้าของแพลตฟอร์ม X (Twitter) ออก 3 แพ็กเกจพรีเมียมใหม่ โดยมีให้เลือกตั้งแต่ราคาสูงสุด 799 บาท ไม่เห็นโฆษณา 100% ตามด้วย 380 บาท และราคาต่ำสุดอยู่ที่ 149 บาทต่อเดือน     สิ่งที่น่าสนใจของแพ็กเกจพรีเมียมราคาสูงสุด 799 บาท คือใช้ได้ทุกฟีเจอร์ และจะไม่เห็นโฆษณา 100% สามารถโพสต์ข้อความและวิดีโอได้ยาวขึ้น ซึ่งบทความที่โพสต์จะติดอันดับต้นๆ บนแพลตฟอร์ม มีบูสต์การตอบกลับมากที่สุด พร้อมสามารถปรับแต่งธีมและไอคอนของแอปได้ และมีฮับผู้สร้างหรือระบบสมาชิก X Pro ให้ใช้งาน รวมถึงมีเครื่องหมายยืนยันตัวตนติ๊กถูกสีฟ้า หรือ Twitter Blue     ข่าวที่เกี่ยวข้อง:  อีลอน มัสก์ เตรียมเปิดฟีเจอร์ที่สามารถให้บริการทางการเงินแบบครบวงจรแก่ผู้ใช้งานบนแพลตฟอร์ม X ในปี 2024 ฝันให้ใหญ่เข้าไว้! ‘อีลอน มัสก์’ เปรยว่า X จะครองสัดส่วนครึ่งหนึ่งของระบบการเงินโลกในอนาคต X อาจสูญเสียรายได้จากโฆษณา 2,700 ล้านบาทภายในสิ้นปีนี้ หลังแบรนด์หยุดแคมเปญจากการที่ Elon Musk…    เช่นเดียวกับแพ็กเกจราคากลาง 380 บาท จะยังเห็นโฆษณาอยู่ 50% นอกนั้นก็สามารถโพสต์ข้อความและวิดีโอได้ยาวขึ้น พร้อมสามารถปรับแต่งธีมและไอคอนของแอป และมีเครื่องหมายยืนยันตัวตนติ๊กถูกสีฟ้าเช่นเดียวกัน      ส่วนแพ็กเกจราคาต่ำสุด 149 บาท จะยังเห็นโฆษณาทั้งหมด แต่สามารถโพสต์ข้อความและวิดีโอได้ยาวขึ้น แต่บูสต์การตอบกลับน้อย และไม่มีเครื่องหมายยืนยันตัวตน     เรียกได้ว่ามีทั้งราคาแบบถูกลงและแพงขึ้น โดยเปิดให้สมัครใช้งานแล้ว ซึ่งหวังเพิ่มจำนวนการสมัครสมาชิกในแอป หลังจากก่อนหน้านี้ราคาแพ็กเกจ X Premium มีแบบเดียวอยู่ที่ 8 ดอลลาร์ หรือประมาณ 279 บาทต่อเดือน โดยสิ่งที่จะได้คือเครื่องหมายยืนยันตัวตนติ๊กถูกสีฟ้า และการใช้งานฟีเจอร์ทั้งหมดในแอป ซึ่งปัจจุบันมีผู้สมัครใช้งานไม่มากนัก"""})
# res = chain.invoke({'input' : """ยานอวกาศที่เดินทางไปไกลจากโลกที่สุดในประวัติศาสตร์ กำลังเผชิญปัญหากับหนึ่งในระบบคอมพิวเตอร์บนยาน ที่ทีมวิศวกรต้องหาทางแก้ปัญหาจากระยะห่างไม่น้อยกว่า 24,000 ล้านกิโลเมตร NASA รายงานผ่านเว็บไซต์ว่า ยาน Voyager 1 ยังสามารถรับข้อมูลจากบนโลก และสามารถปฏิบัติตามคำสั่งได้ตามปกติ แต่มีการพบปัญหากับข้อมูลที่ยานอายุมากกว่า 47 ปีส่งกลับมาโลก  จากการตรวจสอบ ทีมวิศวกรพบปัญหากับ 1 ใน 3 คอมพิวเตอร์บนยาน หรือระบบ Flight Data System จนทำให้อุปกรณ์ Telemetry Modulation Unit ส่งข้อมูลเป็นรูปแบบของเลข 0 กับ 1 ที่ซ้ำกันกลับโลก จนไม่สามารถแปลงค่าเป็นข้อมูลเชิงวิทยาศาสตร์และวิศวกรรมของยานได้ในขณะนี้ ระบบ Flight Data System ถูกออกแบบมาเพื่อเก็บข้อมูลเชิงวิทยาศาสตร์จากอุปกรณ์สำรวจต่างๆ เช่นเดียวกับข้อมูลด้านสุขภาพของยาน ก่อนส่งไปยังอุปกรณ์ Telemetry Modulation Unit ซึ่งคอยทำหน้าที่แปลงสัญญาณข้อมูลทั้งหมดเพื่อส่งกลับมาโลกในรูปของรหัสไบนารี ผ่านเครือข่ายจานรับสัญญาณ Deep Space Network ของ NASA ทีมวิศวกรได้ส่งคำสั่งให้ยานรีสตาร์ทระบบคอมพิวเตอร์ดังกล่าวตั้งแต่ช่วงต้นเดือนธันวาคม ด้วยความหวังว่ายานจะกลับมาทำงานได้เหมือนก่อนช่วงพบปัญหาขึ้น อย่างไรก็ตาม ยาน Voyager 1 ยังไม่สามารถส่งข้อมูลกลับโลกได้ตามที่ควรจะเป็น NASA ระบุว่าอาจต้องใช้เวลาหลายสัปดาห์เพื่อแก้ปัญหาดังกล่าว จากปัจจัยระยะห่างของยานที่ต้องใช้เวลามากกว่า 22.5 ชั่วโมง เพื่อส่งข้อมูลจากโลกไปให้ถึงยาน Voyager 1 ยังไม่รวมถึงการต้องปรึกษาผู้เชี่ยวชาญ และหาข้อมูลจากเอกสารที่มีอายุหลายทศวรรษ เพื่อให้ทีมภารกิจสามารถหาทางแก้ปัญหาดังกล่าวได้ดีที่สุด โดยไม่มีผลกระทบอื่นๆ กับยานอวกาศที่มีอายุมากกว่า 47 ปีลำนี้ Voyager 1 ออกเดินทางจากโลกเมื่อวันที่ 5 กันยายน 1977 เป็นหนึ่งในภารกิจสำรวจอวกาศลึกของ NASA ที่อาศัยตำแหน่งการเรียงตัวของดาวเคราะห์ชั้นนอกทั้ง 4 ดวง ซึ่งเกิดขึ้นเพียงครั้งเดียวในทุก 175 ปี โดย Voyager 1 บินผ่านดาวพฤหัสบดีและดาวเสาร์ในระยะใกล้ ก่อนกลายเป็นยานอวกาศลำแรกที่เดินทางออกสู่ช่องว่างระหว่างดาวฤกษ์ เมื่อวันที่ 25 สิงหาคม 2012"""})
# print(res)